btc_eth_lm <- lm(btc_bimonthly$returns~eth_bimonthly$returns)
btc_lm_res_ts <- ts(btc_eth_lm$residuals,freq=12,start=c(2016,1))
reg_ets_btc <- ets(btc_lm_res_ts)
plot(reg_ets_btc)
reg_ets_btc$residuals
summary(reg_ets_btc)
ets_btc <- ets(btc_ts2)
ggtsdisplay(resid(ets_btc),main = "ARIMA Model Residuals",
ylab = "Percentage")
ggtsdisplay(resid(reg_ets_btc),main = "ETS Model Residuals",
ylab = "Percentage")
plot_resid_fit(fitted(ets_btc),resid(ets_btc),"BTC")
plot_resid_fit <- function(x,y,title) {
data = data.frame(x = x, y = y)
p <- ggplot(data, aes(x =  x, y = y)) +
geom_smooth(method = "lm", se=T,
col = "red",
formula = y ~ x,
show.legend = T) +
scale_x_continuous() +
geom_point(alpha = 0.5,size = 2,
col = "black") +
xlab("Fit") + ylab("Residuals") +
ggtitle(glue("{title} Residuals vs Fit"))
p
}
plot_resid_fit(fitted(reg_arima_btc),resid(reg_arima_btc),"BTC")
plot_resid_fit <- function(x,y,title) {
data = data.frame(x = x, y = y)
p <- ggplot(data, aes(x =  x, y = y)) +
geom_smooth(method = "lm", se=T,
col = "red",
formula = y ~ x,
show.legend = T) +
scale_x_continuous() + scale_y_continuous() +
geom_point(alpha = 0.5,size = 2,
col = "black") +
xlab("Fit") + ylab("Residuals") +
ggtitle(glue("{title} Residuals vs Fit"))
p
}
plot_resid_fit(fitted(reg_arima_btc),resid(reg_arima_btc),"BTC")
plot_resid_fit(fitted(ets_btc),resid(ets_btc),"BTC")
plot_resid_fit <- function(x,y,title) {
data = data.frame(x = x, y = y)
p <- ggplot(data, aes(x =  x, y = y)) +
geom_smooth(method = "lm", se=T,
col = "red",
formula = y ~ x,
show.legend = T) +
scale_x_continuous() + scale_y_continuous() +
geom_point(alpha = 0.5,size = 2,
col = "black") +
xlab("Fit") + ylab("Residuals") +
ggtitle(glue("{title} Residuals vs Fit"))
p
}
plot_resid_fit(fitted(reg_arima_btc),resid(reg_arima_btc),"Regression + ARIMA")
# plot of fitting values
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(cbind(btc_ts,reg_arima_fit),main = "Regression + ARIMA Fit") +
labs("Series","Fit")
autoplot(btc_ts) + autolayer(reg_arima_btc$fitted)
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(cbind(btc_ts,arima_fit),main = "Regression + ARIMA Fit") +
labs("Series","Fit")
arima_btc
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(cbind(btc_ts,arima_fit),main = "ARIMA Fit") +
labs("Series","Fit")
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(cbind(btc_ts,reg_arima_fit),main = "Regression + ARIMA Fit") +
labs("Series","Fit")
ggtsdisplay(resid(ets_btc),main = "ETS Model Residuals",
ylab = "Percentage")
plot_resid_fit(fitted(ets_btc),resid(ets_btc),"BTC")
plot_resid_fit(fitted(ets_btc),resid(ets_btc),"ETS")
plot_resid_fit(fitted(reg_ets_btc),resid(reg_ets_btc),"ETS")
ets_btc_fit <- ts(ets_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(cbind(btc_ts2,ets_btc_fit),main = "ETS Fit") +
labs("Series","Fit")
ets_btc_fit <- ts(ets_btc$fitted,frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,ets_btc_fit),main = "ETS Fit") +
labs("Series","Fit")
reg_ets_fit <- ts(reg_ets_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,reg_ets_fit),main = "ETS Fit") +
labs("Series","Fit")
ets_btc <- ets(btc_ts2)
summary(ets_btc)
btc_eth_lm <- lm(btc_bimonthly$returns~eth_bimonthly$returns)
btc_lm_res_ts <- ts(btc_eth_lm$residuals,freq=12,start=c(2016,1))
reg_ets_btc <- ets(btc_lm_res_ts)
summary(reg_ets_btc)
ggtsdisplay(resid(ets_btc),main = "ETS Model Residuals",
ylab = "Percentage")
ggtsdisplay(resid(reg_ets_btc),main = "Regression + ETS Model Residuals",
ylab = "Percentage")
plot_resid_fit(fitted(ets_btc),resid(ets_btc),"ETS")
plot_resid_fit(fitted(reg_ets_btc),resid(reg_ets_btc),"ETS")
ets_fit <- ts(ets_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,ets_fit),main = "ETS Fit") +
labs("Series","Fit")
reg_ets_fit <- ts(reg_ets_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,reg_ets_fit),main = "Regression + ETS Fit") +
labs("Series","Fit")
ets_btc <- ets(btc_ts2)
summary(ets_btc)
btc_eth_lm <- lm(btc_bimonthly$returns~eth_bimonthly$returns)
btc_lm_res_ts <- ts(btc_eth_lm$residuals,freq=12,start=c(2016,1))
reg_ets_btc <- ets(btc_lm_res_ts)
summary(reg_ets_btc)
reg_ets_fit <- ts(reg_ets_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,reg_ets_fit),main = "Regression + ETS Fit") +
labs("Series","Fit")
y = recresid(ets_btc$res ~ 1)
plot(y, pch = 16, main = "Recursive Residuals", ylab = "Residuals")
tsdisplay(residuals(ets_btc), main = "Autocorrelation of Residuals")
plot(efp(ets_btc$residuals~1, type = "Rec-CUSUM"))
y = recresid(ets_btc$res ~ 1)
plot(y, pch = 16, main = "Recursive Residuals", ylab = "Residuals")
plot(efp(ets_btc$residuals~1, type = "Rec-CUSUM"))
par(mfrow=c(2,1))
y = recresid(ets_btc$res ~ 1)
plot(y, pch = 16, main = "Recursive Residuals", ylab = "Residuals")
plot(efp(ets_btc$residuals~1, type = "Rec-CUSUM"))
par(mfrow=c(1,2))
y = recresid(ets_btc$res ~ 1)
plot(y, pch = 16, main = "Recursive Residuals", ylab = "Residuals")
plot(efp(ets_btc$residuals~1, type = "Rec-CUSUM"))
par(mfrow=c(1,2))
y = recresid(reg_ets_btc$res ~ 1)
plot(y, pch = 16, main = "Recursive Residuals", ylab = "Residuals")
plot(efp(reg_ets_btc$residuals~1, type = "Rec-CUSUM"))
plot(btc_ts)
hw_btc <- hw(btc_ts2,seasonal=c("additive"))
summary(hw_btc)
reg_hw_btc <- hw(btc_lm_res_ts,seasonal=c("additive"))
summary(reg_ets_btc)
ggtsdisplay(resid(hw_btc),main = "HW Model Residuals",
ylab = "Percentage")
ggtsdisplay(resid(reg_hw_btc),main = "Regression + ETS Model Residuals",
ylab = "Percentage")
plot_resid_fit(fitted(hw_btc),resid(hw_btc),"GW")
plot_resid_fit(fitted(reg_hw_btc),resid(reg_hw_btc),"Regression + HW")
gw_fit <- ts(hw_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,gw_fit),main = "HW Fit") +
labs("Series","Fit")
cbind(btc_ts2,reg_hw_fit)
btc_ts2
reg_hw_fit <- ts(reg_hw_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,reg_hw_fit),main = "Regression + HW Fit") +
labs("Series","Fit")
reg_hw_fit <- ts(reg_hw_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,reg_hw_fit),main = "Regression + HW Fit") +
labs("Series","Fit")
par(mfrow=c(1,2))
y = recresid(hw_btc$res ~ 1)
plot(y, pch = 16, main = "Recursive Residuals", ylab = "Residuals")
plot(efp(hw_btc$residuals~1, type = "Rec-CUSUM"))
par(mfrow=c(1,2))
y = recresid(reg_hw_fit$res ~ 1)
par(mfrow=c(1,2))
y = recresid(reg_hw_btc$res ~ 1)
plot(y, pch = 16, main = "Recursive Residuals", ylab = "Residuals")
plot(efp(reg_hw_btc$residuals~1, type = "Rec-CUSUM"))
par(mfrow=c(1,2))
y = recresid(reg_hw_btc$res ~ 1)
plot(y, pch = 16, main = "Recursive Residuals", ylab = "Residuals")
plot(efp(reg_hw_btc$residuals~1, type = "Rec-CUSUM"))
par(mfrow=c(1,2))
y = recresid(arima_btc$res ~ 1)
plot(y, pch = 16, main = "Recursive Residuals", ylab = "Residuals")
plot(efp(arima_btc$residuals~1, type = "Rec-CUSUM"))
par(mfrow=c(1,2))
y = recresid(reg_arima_btc$res ~ 1)
plot(y, pch = 16, main = "Recursive Residuals", ylab = "Residuals")
plot(efp(reg_arima_btc$residuals~1, type = "Rec-CUSUM"))
reg_arima_btc_recresid = recresid(reg_arima_btc$residuals~1)
plot(reg_arima_btc_recresid, ylab="Regression + Arima Fit",
main="Recursive Residuals from Regression + Arima Fit")
ggtsdisplay(resid(hw_btc),main = "HW Model Residuals",
ylab = "Percentage")
ggtsdisplay(resid(reg_hw_btc),main = "Regression + HW Model Residuals",
ylab = "Percentage")
plot_resid_fit(fitted(hw_btc),resid(hw_btc),"HW")
gw_fit <- ts(hw_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,gw_fit),main = "HW Fit") +
labs("Series","Fit")
reg_hw_fit <- ts(reg_hw_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,reg_hw_fit),main = "Regression + HW Fit")  +
ylab("Return") +labs("Series","Fit")
reg_hw_fit <- ts(reg_hw_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,reg_hw_fit),main = "Regression + HW Fit")  +
ylab("Return") + labs(c("Series","Fit"))
reg_hw_fit <- ts(reg_hw_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(btc_ts2) + autolayer(reg_hw_fit) +
ggtitle(main = "Regression + HW Fit")  +
ylab("Return") + labs("Series","Fit")
reg_hw_fit <- ts(reg_hw_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(btc_ts2) + autolayer(reg_hw_fit) +
ggtitle("Regression + HW Fit")  +
ylab("Return") + labs("Series","Fit")
reg_hw_fit <- ts(reg_hw_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(btc_ts2) + autolayer(reg_hw_fit, series="Regression + HW Fit", PI=FALSE) +
ggtitle("Regression + HW Fit")  +
ylab("Return") + labs("Series","Fit")
reg_hw_fit <- ts(reg_hw_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(btc_ts2) + autolayer(reg_hw_fit, series="Regression + HW Fit", PI=TRUE) +
ggtitle("Regression + HW Fit")  +
ylab("Return") + labs("Series","Fit")
autoplot(btc_ts2) + autolayer(reg_hw_btc$fitted, series="Regression + HW Fit") +
ggtitle("Regression + HW Fit")  +
ylab("Return") + labs("Series","Fit")
autoplot(btc_ts2) + ggtitle("Model Fit") +
autolayer(hw_btc$fitted, series="HW Fit") +
autolayer(reg_hw_btc$fitted, series="Regression + HW Fit") +
ylab("Return")
autoplot(btc_ts2) + ggtitle("Model Fit") +
autolayer(hw_btc$fitted, series="HW Fit") +
autolayer(reg_hw_btc$fitted, series="Regression + HW Fit") +
ylab("Return") + xlab("Year")
autoplot(btc_ts2, series="BTC Series") + ggtitle("Model Fit") +
autolayer(hw_btc$fitted, series="HW Fit") +
autolayer(reg_hw_btc$fitted, series="Regression + HW Fit") +
ylab("Return") + xlab("Year")
autoplot(btc_ts2, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(hw_btc$fitted, series="HW Fit") +
autolayer(reg_hw_btc$fitted, series="Regression + HW Fit") +
ylab("Return") + xlab("Year")
plot_resid_fit(fitted(hw_btc),resid(hw_btc),"HW")
par(mfrow(c(2,1)))
par(mfrows(c(2,1)))
par(mfrow(c(2,1)))
par(mfrow=c(1,2))
plot_resid_fit(fitted(hw_btc),resid(hw_btc),"HW")
plot_resid_fit(fitted(reg_hw_btc),resid(reg_hw_btc),"Regression + HW")
par(mfrow=c(1,2))
y = recresid(hw_btc$res ~ 1)
plot(y, pch = 16, main = "Recursive Residuals", ylab = "Residuals")
plot(efp(hw_btc$residuals~1, type = "Rec-CUSUM"))
par(mfrow=c(1,2))
y = recresid(hw_btc$res ~ 1)
plot(y, pch = 16, main = "HW Recursive Residuals", ylab = "Residuals")
plot(efp(hw_btc$residuals~1, type = "Rec-CUSUM"))
par(mfrow=c(1,2))
y = recresid(reg_hw_btc$res ~ 1)
plot(y, pch = 16, main = "Reg + HW Recursive Residuals", ylab = "Residuals")
plot(efp(reg_hw_btc$residuals~1, type = "Rec-CUSUM"))
ggtsdisplay(resid(hw_btc),main = "HW Model Residuals",
ylab = "Percentage")
par(mfrow=c(1,2))
ggtsdisplay(resid(hw_btc),main = "HW Model Residuals", ylab = "Percentage")
ggtsdisplay(resid(reg_hw_btc),main = "Regression + HW Model Residuals", ylab = "Percentage")
par(mfrow=c(1,2))
p1 <- ggtsdisplay(resid(hw_btc),main = "HW Model Residuals", ylab = "Percentage")
p2 <- ggtsdisplay(resid(reg_hw_btc),main = "Regression + HW Model Residuals", ylab = "Percentage")
grid.arrange(p1,p2,ncol=2)
grid.arrange(p1,p2,ncol=2)
p1 <- ggtsdisplay(resid(hw_btc),main = "HW Model Residuals", ylab = "Percentage")
p2 <- ggtsdisplay(resid(reg_hw_btc),main = "Regression + HW Model Residuals", ylab = "Percentage")
grid.arrange(p1,p2,ncol=2,nrow=2)
ggtsdisplay(resid(hw_btc),main = "HW Model Residuals", ylab = "Percentage")
ggtsdisplay(resid(reg_hw_btc),main = "Regression + HW Model Residuals", ylab = "Percentage")
plot_resid_fit(fitted(hw_btc),resid(hw_btc),"HW")
plot_resid_fit(fitted(reg_hw_btc),resid(reg_hw_btc),"Regression + HW")
par(mfrow=c(1,2))
y = recresid(hw_btc$res ~ 1)
plot(y, pch = 16, main = "HW Recursive Residuals", ylab = "Residuals")
plot(efp(hw_btc$residuals~1, type = "Rec-CUSUM"))
autoplot(btc_ts2, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(ets_btc$fitted, series="ETS Fit") +
autolayer(reg_ets_btc$fitted, series="Regression + ETS Fit") +
ylab("Return") + xlab("Year")
reg_ets_fit <- ts(reg_ets_btc$fitted, frequency = 12, start = c(2016,1))
autoplot(cbind(btc_ts2,reg_ets_fit),main = "Regression + ETS Fit") +
labs("Series","Fit")
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_btc$fitted, series="Arima") +
autolayer(reg_arima_btc$fitted, series="Regression + Arima") +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted, frequency = 365, start = c(2016,1))
autoplot(cbind(btc_ts,arima_fit),main = "ARIMA Fit") +
labs("Series","Fit")
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(cbind(btc_ts,reg_arima_fit),main = "Regression + ARIMA Fit") +
labs("Series","Fit")
autoplot(btc_ts, series="BTC Series", col="black")
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_btc$fitted, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima") +
ylab("Return") + xlab("Year")
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_btc$fitted, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima") +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_fit$fitted, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima") +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_fit, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima") +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_fit, series="Arima")+
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_fit, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima") +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_fit, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima", alpha = 0.2) +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_fit, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima", alpha = 0.5) +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_fit, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima", alpha = 0.4) +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_fit, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima", alpha = 0.7) +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(arima_fit, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima", alpha = 0.6) +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black", alpha = 0.5) + ggtitle("Model Fit") +
autolayer(arima_fit, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima", alpha = 0.6) +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black", alpha = 0.7) + ggtitle("Model Fit") +
autolayer(arima_fit, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima", alpha = 0.6) +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black", alpha = 0.9) + ggtitle("Model Fit") +
autolayer(arima_fit, series="Arima") +
autolayer(reg_arima_fit, series="Regression + Arima", alpha = 0.6) +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black", alpha = 0.9) + ggtitle("Model Fit") +
autolayer(reg_arima_fit, series="Regression + Arima", alpha = 0.6) +
autolayer(arima_fit, series="Arima") +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black", alpha = 0.8) + ggtitle("Model Fit") +
autolayer(reg_arima_fit, series="Regression + Arima", alpha = 0.8) +
autolayer(arima_fit, series="Arima") +
ylab("Return") + xlab("Year")
arima_fit <- ts(arima_btc$fitted,frequency = 365, start = c(2016,1))
reg_arima_fit <- ts(reg_arima_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Series", col="black", alpha = 0.9) + ggtitle("Model Fit") +
autolayer(reg_arima_fit, series="Regression + Arima", alpha = 0.9) +
autolayer(arima_fit, series="Arima") +
ylab("Return") + xlab("Year")
ggtsdisplay(resid(arima_btc),main = "ARIMA Residuals", ylab = "Percentage")
ggtsdisplay(resid(reg_arima_btc), main = "Regression + ARIMA Residuals", ylab = "Percentage")
hw_btc <- hw(btc_ts2,seasonal=c("additive"))
summary(hw_btc)
autoplot(btc_ts2, series="BTC Series", col="black") + ggtitle("Model Fit") +
autolayer(hw_btc$fitted, series="HW") +
autolayer(reg_hw_btc$fitted, series="Regression + HW") +
ylab("Return") + xlab("Year")
nnar_btc <- nnetar(btc_ts)
nnar_btc <- nnetar(btc_ts)
btc_eth_lm <- lm(returns$btc~returns$eth_ts)
reg_nnar_btc <- nnetar(btc_eth_lm$residuals, xreg=cbind(returns$btc_ts,returns$eth_ts))
nnar_btc <- nnetar(btc_ts)
btc_eth_lm <- lm(returns$btc~returns$eth_ts)
reg_nnar_btc <- nnetar(btc_eth_lm$residuals, xreg=cbind(returns$btc_ts,returns$eth_ts))
autoplot(btc_ts, series="BTC Returns", color="Black") +
autolayer(nnar_btc$fitted, series="NNAR Model Returns") +
autolayer(reg_nnar_btc$fitted, series="LM of Returns + NNAR Model of Residuals") +
ggtitle("NNAR Model Fits for BTC Returns")
nnar_btc <- nnetar(btc_ts)
btc_eth_lm <- lm(returns$btc~returns$eth_ts)
reg_nnar_btc <- nnetar(btc_eth_lm$residuals, xreg=cbind(returns$btc_ts,returns$eth_ts))
autoplot(btc_ts, series="BTC Returns") +
autolayer(nnar_btc$fitted, series="NNAR Model Returns") +
autolayer(reg_nnar_btc$fitted, series="LM of Returns + NNAR Model of Residuals") +
ggtitle("NNAR Model Fits for BTC Returns")
nnar_btc <- nnetar(btc_ts)
btc_eth_lm <- lm(returns$btc~returns$eth_ts)
reg_nnar_btc <- nnetar(btc_eth_lm$residuals, xreg=cbind(returns$btc_ts,returns$eth_ts))
nnar_fit <- ts(nnar_btc$fitted,frequency = 365, start = c(2016,1))
reg_nnar_fit <- ts(reg_nnar_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Returns") +
autolayer(nnar_fit, series="NNAR Model Returns") +
autolayer(reg_nnar_fit, series="LM of Returns + NNAR Model of Residuals") +
ggtitle("NNAR Model Fits for BTC Returns")
nnar_btc <- nnetar(btc_ts)
btc_eth_lm <- lm(returns$btc~returns$eth_ts)
reg_nnar_btc <- nnetar(btc_eth_lm$residuals, xreg=cbind(returns$btc_ts,returns$eth_ts))
nnar_fit <- ts(nnar_btc$fitted,frequency = 365, start = c(2016,1))
reg_nnar_fit <- ts(reg_nnar_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Returns", color="black") +
autolayer(nnar_fit, series="NNAR Model Returns") +
autolayer(reg_nnar_fit, series="LM of Returns + NNAR Model of Residuals") +
ggtitle("NNAR Model Fits for BTC Returns")
nnar_btc <- nnetar(btc_ts)
btc_eth_lm <- lm(returns$btc~returns$eth_ts)
reg_nnar_btc <- nnetar(btc_eth_lm$residuals, xreg=cbind(returns$btc_ts,returns$eth_ts))
nnar_fit <- ts(nnar_btc$fitted,frequency = 365, start = c(2016,1))
reg_nnar_fit <- ts(reg_nnar_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Returns", color="black", alpha = 0.8) +
autolayer(nnar_fit, series="NNAR", alpha = 0.8) +
autolayer(reg_nnar_fit, series="Regression + NNAR", alpha = 0.8) +
ggtitle("Model Fit")
nnar_btc <- nnetar(btc_ts)
btc_eth_lm <- lm(returns$btc~returns$eth_ts)
reg_nnar_btc <- nnetar(btc_eth_lm$residuals, xreg=cbind(returns$btc_ts,returns$eth_ts))
nnar_fit <- ts(nnar_btc$fitted,frequency = 365, start = c(2016,1))
reg_nnar_fit <- ts(reg_nnar_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Returns", color="black", alpha = 0.8) +
autolayer(nnar_fit, series="NNAR", alpha = 0.8) + ggtitle("Model Fit")
autoplot(btc_ts, series="BTC Returns", color="black", alpha = 0.8) +
autolayer(reg_nnar_fit, series="Regression + NNAR", alpha = 0.8) +
ggtitle("Model Fit")
nnar_btc <- nnetar(btc_ts)
btc_eth_lm <- lm(returns$btc~returns$eth_ts)
reg_nnar_btc <- nnetar(btc_eth_lm$residuals, xreg=cbind(returns$btc_ts,returns$eth_ts))
nnar_fit <- ts(nnar_btc$fitted,frequency = 365, start = c(2016,1))
reg_nnar_fit <- ts(reg_nnar_btc$fitted,frequency = 365, start = c(2016,1))
autoplot(btc_ts, series="BTC Returns", color="black", alpha = 0.9) +
autolayer(nnar_fit, series="NNAR", alpha = 0.9) + ggtitle("Model Fit")
autoplot(btc_ts, series="BTC Returns", color="black", alpha = 0.9) +
autolayer(reg_nnar_fit, series="Regression + NNAR", alpha = 0.9) +
ggtitle("Model Fit")
nnar_btc <- nnetar(btc_ts)
summary(nnar_btc)
checkresiduals(nnar_btc, main="Residuals from NNETAR Model of BTC Returns")
checkresiduals(reg_nnar_btc$residuals, main="Residuals from Linear Model with NNETAR Model of Residuals")
checkresiduals(nnar_btc, main="Residuals from NNETAR Model of BTC Returns")
checkresiduals(reg_nnar_btc$residuals, main="Residuals from Linear Model with NNETAR Model of Residuals")
ggtsdisplay(resid(nnar_btc),main = "NNAR Residuals", ylab = "Percentage")
ggtsdisplay(resid(reg_nnar_btc),main = "Regression + NNAR Residuals", ylab = "Percentage")
ggtsdisplay(resid(nnar_btc),main = "NNAR Residuals", ylab = "Percentage")
ggtsdisplay(resid(reg_nnar_btc),main = "Regression + NNAR Residuals", ylab = "Percentage")
plot_resid_fit(fitted(nnar_btc),resid(nnar_btc),"NNAR")
plot_resid_fit(fitted(reg_nnar_btc),resid(reg_nnar_btc),"Regression + NNAR")
plot_resid_fit(fitted(nnar_btc),resid(nnar_btc),"NNAR")
plot_resid_fit(fitted(reg_nnar_btc),resid(reg_nnar_btc),"Regression + NNAR")
par(mfrow=c(1,2))
y = recresid(nnar_btc$res ~ 1)
plot(y, pch = 16, main = "NNAR  Residuals", ylab = "Recursive Residuals")
plot(efp(nnar_btc$residuals~1, type = "Rec-CUSUM"))
par(mfrow=c(1,2))
y = recresid(reg_nnar_btc$res ~ 1)
plot(y, pch = 16, main = "Regression + NNAR Residuals", ylab = "Recursive Residuals")
plot(efp(reg_nnar_btc$residuals~1, type = "Rec-CUSUM"))
library(prophet)
preds_btc <- prophet(df_r_btc,daily.seasonality=TRUE)
df_r_btc <- data.frame(ds = btc$timestamp, y = as.numeric(btc$returns))
df_r_btc <- data.frame(ds = btc$timestamp, y = as.numeric(btc$returns))
preds_btc <- prophet(df_r_btc,daily.seasonality=TRUE)
future_btc <- make_future_dataframe(preds_btc, periods = 60)
forecast_btc <- predict(preds_btc, future_btc)
forecast_btc <- predict(preds_btc, future_btc)
plot(preds_btc,
forecast_btc,
main="BTC Returns",
ylab = "Percentage",
xlab = "Time")
plot(preds_btc,
forecast_btc,
main="BTC Returns",
ylab = "Percentage",
xlab = "Time")
prophet_plot_components()
prophet_plot_components(preds_btc)
prophet_plot_components(future_btc)
prophet_plot_components(forecast_btc)
prophet_plot_components(preds_btc, forecast_btc)
plot_cross_validation_metric()
summary(preds_btc)
autoplot(btc_ts, series="BTC Returns", color="black", alpha = 0.9) +
autolayer(preds_btc, series="Regression + NNAR", alpha = 0.9) +
ggtitle("Model Fit")
ggtsdisplay(resid(preds_btc),main = "NNAR Residuals", ylab = "Percentage")
prophet <- prophet(btc_ts ~ season(period = 4, order = 2,
prophet <- prophet(btc_ts ~ season(period = 4, order = 2, type = "multiplicative")
